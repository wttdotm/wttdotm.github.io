<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extracted Div</title>
<script src="../wttdotmBespokePixel.js"></script>
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300;400;500;600;700&display=swap">
<link rel="icon" href="/assets/favicon/favicon.ico" sizes="any">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="192x192" href="/assets/favicon/icon-192x192.png">
<style>

  body {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    max-width: 100%;
    background-color: #000;
    /* background-image: url("https://play.pokemonshowdown.com/sprites/gen6bgs/bg-aquacordetown.jpg"); */
    background-size: 800px;
    /* background-position: left top; */
    background-position: center top -100px;
    /* background-repeat: no-repeat; */
    /* overflow: hidden; */
  }
/* Inline styles applied directly to .innerbattle */
.innerbattle {
font-family: Verdana, sans-serif;
font-kerning: auto;
font-optical-sizing: auto;
font-palette: normal;
font-size: 13.3333px;
font-size-adjust: none;
font-stretch: 100%;
font-style: normal;
font-synthesis-small-caps: auto;
font-synthesis-style: auto;
font-synthesis-weight: auto;
font-variant: normal;
font-variant-alternates: normal;
font-variant-caps: normal;
font-variant-east-asian: normal;
font-variant-emoji: normal;
font-variant-ligatures: normal;
font-variant-numeric: normal;
font-variant-position: normal;
font-weight: 400;
grid-auto-columns: auto;
grid-auto-flow: row;
grid-auto-rows: auto;
grid-column-end: auto;
grid-column-start: auto;
grid-row-end: auto;
grid-row-start: auto;
grid-template-areas: none;
grid-template-columns: none;
grid-template-rows: none;
/* height: 360px; */
hyphenate-character: auto;
hyphenate-limit-chars: auto;
hyphens: manual;
image-orientation: from-image;
image-rendering: auto;
initial-letter: normal;
inline-size: 640px;

display: flex; 
flex-direction: column; 
align-items: center; 
justify-content: center; 

max-width: 80vw
/* background-image: url(https://play.pokemonshowdown.com/sprites/gen6bgs/bg-aquacordetown.jpg); 
background-position: center top -100px;
background-size: 100%; */

}


/* S */
/* Extracted CSS rules affecting the div */
.statbar {display: none; width: 154px; min-height: 40px; padding: 2px 4px; }
.statbar strong { margin: 0px -15px; display: block; text-align: center; color: rgb(34, 34, 34); text-shadow: rgb(255, 255, 255) 1px 1px 0px, rgb(255, 255, 255) 1px -1px 0px, rgb(255, 255, 255) -1px 1px 0px, rgb(255, 255, 255) -1px -1px 0px; }
.statbar strong small { font-weight: normal; }
.statbar .hpbar { position: relative; border: 1px solid rgb(119, 119, 119); background: rgb(252, 254, 255); padding: 1px; height: 8px; margin: 0px; width: 151px; border-radius: 4px; }
.statbar .hpbar .hp { height: 4px; border-top: 2px solid rgb(0, 221, 96); background: rgb(0, 187, 81); border-bottom: 2px solid rgb(0, 119, 52); border-right: 1px solid rgb(0, 119, 52); border-radius: 3px; }
.statbar .hpbar .prevhp { background: rgb(187, 238, 204); height: 8px; border-radius: 3px; }
.statbar .hpbar .hptext { position: absolute; background: rgb(119, 119, 119); color: rgb(238, 238, 238); text-shadow: rgb(0, 0, 0) 0px 1px 0px; font-size: 9px; width: 32px; height: 12px; top: -1px; text-align: center; -webkit-text-fill-color: rgb(238, 238, 238); }
.statbar .hpbar .hptextborder { position: absolute; background: transparent; border-top: 1px solid rgb(119, 119, 119); border-bottom: 1px solid rgb(119, 119, 119); width: 4px; top: -1px; height: 10px; }
.statbar span {
    padding: 0px 1px;
    border: 1px solid rgb(255, 68, 0);
    border-radius: 3px;
}

.statbar span.bad {
    background: rgb(255, 229, 224);
    color: rgb(255, 68, 0);
    border-color: rgb(255, 68, 0);
    -webkit-text-fill-color: rgb(255, 68, 0);
}

.statbar span.good {
    background: rgb(229, 255, 224);
    color: rgb(51, 170, 0);
    border-color: rgb(51, 170, 0);
    -webkit-text-fill-color: rgb(51, 170, 0);
}

.statbar span.brn, .statbar span.psn, .statbar span.slp, .statbar span.par, .statbar span.frz, .statbar span.tox {
    padding: 1px 2px;
    border: 0px;
    border-radius: 3px;
    -webkit-text-fill-color: rgb(255, 255, 255);
}

.statbar span.brn {
    background: rgb(238, 85, 51);
    color: rgb(255, 255, 255);
    -webkit-text-fill-color: rgb(255, 255, 255);
}

.statbar span.psn, span.tox {
	background: #A4009A;
}
.statbar span.par {
	background: #9AA400;
}
.statbar span.slp {
	background: #AA77AA;
}
.statbar span.frz {
	background: #009AA4;
}


.statbar .status {
    display: flex;
    flex-wrap: wrap;
    gap: 2px;
    min-height: 10px;
    font-size: 7pt;
}

.statbar .status img {
    vertical-align: top;
    top: -2px;
    position: relative;
}

@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {
    .pixelated, .itemicon, .picon, .trainersprite {
        image-rendering: pixelated;
    }
}

.rstatbar .hpbar .hptext { right: -32px; border-radius: 0px 4px 4px 0px; }
.rstatbar .hpbar .hptextborder { right: -3px; }
.messagebar { position: absolute; display: none; bottom: 10px; left: 110px; right: 110px; color: rgb(204, 204, 204); background: rgba(0, 0, 0, 0.75); border-radius: 6px; padding: 4px 6px 0px; overflow: hidden; }
.messagebar strong { color: rgb(255, 255, 255); font-size: 12pt; }
.messagebar p { display: none; margin: 0px; padding: 0px; }
.weather { position: absolute; display: block; inset: 0px; text-shadow: rgb(255, 255, 255) 1px 1px 0px, rgb(255, 255, 255) 1px -1px 0px, rgb(255, 255, 255) -1px 1px 0px, rgb(255, 255, 255) -1px -1px 0px; color: black; }
.weather em { display: block; margin: 24px 0px 0px 115px; font-size: 12pt; }
.picon { display: inline-block; width: 40px; height: 30px; }
.trainer .picon { margin: 0px -4px; }
.pixelated, .itemicon, .picon, .trainersprite { image-rendering: pixelated; }
.status { color: white; border-radius: 3px; padding: 0px 2px; }

/* New styles for userSelections */
.userSelections {
  /* position: fixed;
  bottom: 20px;
  left: 25%;
  transform: translateX(-50%); */
  background: rgb(218, 229, 240);
  border: 1px solid rgb(153, 153, 153);
  border-radius: 5px;
  /* padding: 20px; */
  box-shadow: rgba(255, 255, 255, 0.6) 1px 1px 0px inset;
  font-family: Verdana, sans-serif;
  /* min-width: 100vw; */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-width: 100%;
}

.userSelections .inner {
  display: flex;
  flex-direction: column;
  /* align-items: center; */
  justify-content: center;
  /* max-width: 100vw; */
  width: 100%;
  margin-top: 20px;
  margin-left: 30px;
  /* padding-right: 30px */
  /* padding-left: 30px;
  padding-right: 30px; */
}

.userSelections input[type="text"] {
  display: block;
  padding: 1px;
  margin: 2px 3px 1px 1px;
  width: 129px;
  height: 20px;
  border: 1px solid rgb(170, 170, 170);
  border-radius: 3px;
  box-shadow: rgb(204, 204, 204) 0px 1px 2px inset, rgba(255, 255, 255, 0.6) 1px 1px 0px;
  background: rgb(248, 251, 253);
}

.userSelections button {
  background: transparent;
  border: 1px solid rgb(170, 170, 170);
  border-radius: 4px;
  padding: 2px 5px;
  margin: 0px;
  font-size: 9pt;
  font-family: Verdana, sans-serif;
}

.userSelections label {
  display: block;
  font-size: 8pt;
  font-weight: bold;
  color: rgb(85, 85, 85);
  padding-left: 2px;
  margin-bottom: 2px;
}

.userSelections input[type="radio"],
.userSelections input[type="checkbox"] {
  margin-right: 5px;
}

.userSelections div {
  margin-bottom: 10px;
}

.userSelections input[type="number"] {
  width: 60px;
  padding: 1px;
  border: 1px solid rgb(170, 170, 170);
  border-radius: 3px;
  box-shadow: rgb(204, 204, 204) 0px 1px 2px inset, rgba(255, 255, 255, 0.6) 1px 1px 0px;
  background: rgb(248, 251, 253);
}

.monContainer {
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  justify-content: center; 
  opacity: 1; 
  height: 100%;
  min-height: 40%;
  width: 100%;
  background-image: url(https://play.pokemonshowdown.com/sprites/gen6bgs/bg-aquacordetown.jpg); 
  background-position: center top -100px;
  background-size: 100%;
  border-radius: 5px;
}

.userSelections .inner div {
    min-width: 0;
}

/* Extra small devices (phones, 600px and down) */
@media only screen and (max-width: 700px) {
  .monContainer {
    background-position: center top -70px;
    background-size: auto;

  }

  .badAppleButton {
    display: none;
  }

  .kevinBlasting {
    display: none;
  }

  
  body {
    justify-content: flex-start;
  }
  
  .innerbattle {
    margin-top: 5vh;
  }
}

.credits {
  color: rgba(255, 255, 255, 0.5);
  margin-top: 10px;
  margin-bottom: 10px;
}

.credits a {
  color: rgba(255, 255, 255, 0.5);
  text-decoration: underline;
}

.credits a:hover {
  color: rgba(255, 255, 255, 1);
}

</style>
<script src="fullDex.js"></script>
<script>
  function remove(el) {
  var element = el;
  element.remove();
}

let numSpikes = 0;
let numTSpikes = 0;
let numStickyWeb = 0;
let numRocks = 0;
let firstMon = "Quagsire"
let nickname = "";
</script>
</head>
<body>
<!-- <div class="backdrop" style="position:absolute; background-image:url(https://play.pokemonshowdown.com/sprites/gen6bgs/bg-aquacordetown.jpg);display:block;opacity:0.8"></div> -->
<div class="innerbattle">
  <div class="monContainer">

    <div class="statbar rstatbar leftstatbar" style="display: flex; flex-direction: column; align-items: center; left: 130px; top: 20px; opacity: 1;">
      <div id="hazards" style="position: relative; z-index: 3; top: -20px;">
        <div id="spikes" class="spikes">
            <img src="https://play.pokemonshowdown.com/fx/caltrop.png" style="display: none; position: absolute; left: -50px; top: 138px; width: 32px; height: 32px; opacity: 1;"> 
            <img src="https://play.pokemonshowdown.com/fx/caltrop.png" style="display: none; position: absolute; left: 25px; top: 148px; width: 32px; height: 32px; opacity: 1;">
            <img src="https://play.pokemonshowdown.com/fx/caltrop.png" style="display: none; position: absolute; left: 50px; top: 138px; width: 32px; height: 32px; opacity: 1;">
        </div>
        <div id="tspikes" class="tspikes">
          <img src="https://play.pokemonshowdown.com/fx/poisoncaltrop.png" style="display: none; position: absolute; left: -10px; top: 138px; width: 32px; height: 32px; opacity: 1;">
          <img src="https://play.pokemonshowdown.com/fx/poisoncaltrop.png" style="display: none; position: absolute; left: -38px; top: 132px; width: 32px; height: 32px; opacity: 1;">
        </div>
        <div id="webs" class="webs">
          <img src="https://play.pokemonshowdown.com/fx/web.png" style="display:none;position:absolute;left: -28px; top: 55px; width: 84px; height: 85px; opacity: 0.4; zoom: 1.5;">
        </div>
         <div id="rocksOpp" style="display: none;" class="rocks opp">
           <img src="https://play.pokemonshowdown.com/fx/rock1.png" style="position: absolute; left: -63px; top: 102px; width: 16px; height: 24px; opacity: 0.5;">
           <img src="https://play.pokemonshowdown.com/fx/rock1.png" style="position: absolute; left: 33px; top: 117px; width: 16px; height: 24px; opacity: 0.5;">
           <img src="https://play.pokemonshowdown.com/fx/rock2.png" style="position: absolute; left: 5px; top: 133px; width: 20px; height: 21px; opacity: 0.5">
           <img src="https://play.pokemonshowdown.com/fx/rock2.png" style="position: absolute; left: -37px; top: 145px; width: 20px; height: 21px; opacity: 0.5">
          </div>
          <div id="rocksSelf" style="display: none;" class="rocks self">
            <img src="https://play.pokemonshowdown.com/fx/rock1.png" style="position: absolute; left: 47px; top: 102px; width: 16px; height: 24px; opacity: 0.5;">
            <img src="https://play.pokemonshowdown.com/fx/rock1.png" style="position: absolute; left: -47px; top: 117px; width: 16px; height: 24px; opacity: 0.5;">
            <img src="https://play.pokemonshowdown.com/fx/rock2.png" style="position: absolute; left: -25px; top: 133px; width: 20px; height: 21px; opacity: 0.5">
            <img src="https://play.pokemonshowdown.com/fx/rock2.png" style="position: absolute; left: 17px; top: 145px; width: 20px; height: 21px; opacity: 0.5">
           </div>
        <!-- <img src="https://play.pokemonshowdown.com/fx/caltrop.png" style="display: block; position: relative; left: 55px; top: 168px; width: 24px; height: 24px; opacity: 1;"> -->
        <!-- <img src="https://play.pokemonshowdown.com/fx/caltrop.png" style="display: block; position: relative; left: 75px; top: 163px; width: 24px; height: 24px; opacity: 1;"> -->
      </div>
      <div style="text-align: center; position: relative; top: -10px;">
        <strong><span id="pokemonName" style="border: none;">Regirock</span> <img id="pokemonGender" src="https://play.pokemonshowdown.com/fx/gender-f.png" alt="F" width="7" height="10" class="pixelated"> <small id="pokemonLevel" style="display: none;">L100</small></strong>
      </div>
      <div class="hpbar" style="position: relative; top: -10px; z-index: 40;">
        <div class="hptext">100%</div>
        <div class="hptextborder"></div>
        <div class="prevhp" style="width: 151px;">
          <div class="hp" style="width: 150px; border-right-width: 1px;"></div>
        </div>
        <div class="status">
            <span id="pokemonStatus" style="display: none; width: fit-content;" onclick="updateStatus('none')"></span> <img id="pokemonTera" style="display: none; width: fit-content;" src="https://play.pokemonshowdown.com/sprites/types/Steel.png" alt="Steel" class="pixelated" onclick="updateTeraType('none')">
            <span id="statAtk" class="good" style="display: none; width: fit-content;">1.0x Atk</span>
            <span id="statDef" class="good" style="display: none; width: fit-content;">1.0x Def</span>
            <span id="statSpA" class="good" style="display: none; width: fit-content;">1.0x SpA</span>
            <span id="statSpD" class="good" style="display: none; width: fit-content;">1.0x SpD</span>
            <span id="statSpe" class="good" style="display: none; width: fit-content;">1.0x Spe</span>
        </div>
      </div>
      <div class="sprite-container" style="position: relative; z-index: 1; min-height: 120px; display: flex; align-items: center; justify-content: center;">
        <img id="pokemonSprite" src="https://play.pokemonshowdown.com/sprites/ani/regirock.gif" style="display: block; opacity: 1; z-index: 2; max-height: 120px; transform: scale(1.1);">
        <!-- <img id="pokemonSprite" src="https://play.pokemonshowdown.com/sprites/ani/regirock.gif" style="display: block; height: 115px; margin-top: 15px; opacity: 1; z-index: 2;"> -->
      </div>
    </div>
    </div>
    <div class="credits">By WTTDOTM! <a href="https://wttdotm.com" target="_blank">Website</a>, <a href="https://twitter.com/wttdotm" target="_blank">Twitter</a>, <a href="https://instagram.com/wttdotm" target="_blank">Instagram</a>, <span class="kevinBlasting"><a href="https://replay.pokemonshowdown.com/gen9draft-2289579996">Me blasting my friend kevin in draft lol</a></span></div>




<script>
function addStatusText(goodBad, text = null) {
  let textToAdd = "";
  if (text) {
    textToAdd = text;
  } else {
    input = document.getElementById('statusInput');
    if (!input.value.length) {
      return
    }
    textToAdd = input.value;
  }
  const status = document.querySelector('.status');
  const span = document.createElement('span');
  span.className = goodBad;
  span.textContent = textToAdd;
  span.onclick = function() {
    remove(this);
  }
  status.appendChild(span);
  status.appendChild(document.createTextNode(' '));
  if (!text) {
    input.value = ''; // Clear input after adding

  }
}

</script>
<div class="userSelections">
  <div class="inner">
<script>


function handleInput(value) {
    // console.log(value);
  const input = value.toLowerCase();
  const autocompleteSpan = document.getElementById('autocomplete');
  const pokemonInput = document.getElementById('pokemonInput');
  
  // Find first matching pokemon name
  const match = Object.keys(dex).find(name => 
    name.toLowerCase().startsWith(input)
  );

  // console.log(match);

  if (match && input) {
    // Show autocomplete
    autocompleteSpan.textContent = match;
    // Position the span
    autocompleteSpan.style.top = pokemonInput.offsetTop + 'px';
    autocompleteSpan.style.left = pokemonInput.offsetLeft + 'px';
  } else {
    autocompleteSpan.textContent = '';
  }
}

function handleNicknameInput(value = "") {
  // console.log("nickname", value);
  nickname = value;
  if (nickname.length) {
    document.getElementById('pokemonName').innerText = nickname;
  } else {
    updatePokemon();
  }
}

function handleKeyDown(event) {
  if (event.key === 'Enter') {
    updatePokemon();
  } else if (event.key === "Tab") {
    updatePokemon();
  }
}

function updateMonScale(value) {
  const sprite = document.getElementById('pokemonSprite');
  sprite.style.transform = `scale(${value})`;
}

function resetAll() {
  // Reset Pokemon to default
  firstMon = "Quagsire";
  nickname = "";
  document.getElementById('pokemonInput').value = "";
  document.getElementById('nicknameInput').value = "";
  document.getElementById('autocomplete').textContent = "Quagsire";

  // Reset status effect
  document.getElementById('statusEffect').value = "none";
  updateStatus('none');

  // Reset tera type
  document.getElementById('teraType').value = "none";
  updateTeraType('none');

  // Reset stat modifiers
  ['Atk', 'Def', 'SpA', 'SpD', 'Spe'].forEach(stat => {
    document.getElementById('select' + stat).value = '0';
    updateStatMod(stat, '0');
  });

  // Reset hazards
  numSpikes = 0;
  numTSpikes = 0;
  numStickyWeb = 0;
  numRocks = 0;
  document.querySelectorAll('select[onchange*="numSpikes"], select[onchange*="numTSpikes"], select[onchange*="numStickyWeb"], select[onchange*="numRocks"]').forEach(select => {
    select.value = '0';
  });

  // Reset side/gender/shiny/level
  document.getElementById('sideSelect').value = 'front';
  document.getElementById('genderSelect').value = 'M';
  document.getElementById('shinyToggle').checked = false;
  document.getElementById('levelInput').value = 100;
  document.getElementById('pokemonLevel').style.display = 'none';

  // Clear custom status text
  document.querySelectorAll('.status span.good, .status span.bad').forEach(span => {
    if (span.id !== 'pokemonStatus' && !span.id.startsWith('stat')) {
      span.remove();
    }
  });
  document.getElementById('statusInput').value = '';

  // Reset background
  document.getElementById('backgroundSelect').value = 'bg-aquacordetown.jpg';
  updateBackground('bg-aquacordetown.jpg');

  // Reset mon scale
  document.getElementById('monScaleSlider').value = 1.1;
  updateMonScale(1.1);

  // Update pokemon to apply all changes
  updatePokemon();
}
</script>
<div style="margin-bottom: 0px; display: flex; gap: 15px; flex-wrap: wrap;">
  <div style="display: flex; flex-direction: column; gap: 5px;">
    <label>Change Pokemon:</label>
    <input type="text" id="pokemonInput" placeholder="Enter Pokemon name" style="width: 100%;" oninput="handleInput(this.value)" onkeydown="if(event.key === 'Tab') { event.preventDefault(); if(document.getElementById('autocomplete').textContent) { updatePokemon() } } else if(event.key === 'Enter') { handleKeyDown(event) }"><span id="autocomplete" style="display: none;"> </span>
    <input type="text" id="nicknameInput" placeholder="Nickname" style="width: 100%;" oninput="handleNicknameInput(this.value)">
    <div style="display: flex; flex-direction: column; gap: 5px;">
      <button onclick="updatePokemon()">Change</button>
      <div style="display: flex; flex-direction: row; gap: 5px; align-items: center;">
        <label style="margin: 0; font-size: 9pt; white-space: nowrap;">Mon Scale:</label>
        <input type="range" id="monScaleSlider" min="0.8" max="1.4" step="0.1" value="1.1" oninput="updateMonScale(this.value)" style="width: 80px;">
      </div>
    </div>
  </div>

  <div style="display: flex; flex-direction: column; gap: 5px; margin-bottom: 0px;">
    <label>Basic Modifiers:</label>
    <select id="statusEffect" onchange="updateStatus(this.value)" style="width: 100px;">
      <option value="none" selected>Status</option>
      <option value="brn">Burn</option>
      <option value="frz">Freeze</option>
      <option value="par">Para</option>
      <option value="psn">Poison</option>
      <option value="tox">Toxic</option>
      <option value="slp">Sleep</option>
    </select>
    <select id="teraType" onchange="updateTeraType(this.value)" style="width: 100px;">
      <option value="none" selected>Tera</option>
      <option value="normal">Normal</option>
      <option value="fire">Fire</option>
      <option value="water">Water</option>
      <option value="electric">Electric</option>
      <option value="grass">Grass</option>
      <option value="ice">Ice</option>
      <option value="fighting">Fighting</option>
      <option value="poison">Poison</option>
      <option value="ground">Ground</option>
      <option value="flying">Flying</option>
      <option value="psychic">Psychic</option>
      <option value="bug">Bug</option>
      <option value="rock">Rock</option>
      <option value="ghost">Ghost</option>
      <option value="dragon">Dragon</option>
      <option value="dark">Dark</option>
      <option value="steel">Steel</option>
      <option value="fairy">Fairy</option>
      <option value="stellar">Stellar</option>
    </select>
    <!-- <div style="display: flex; gap: 5px;"> -->
      <select id="sideSelect" onchange="updatePokemon()" style="width: 100px;">
        <option value="front" selected>Opp. Mon</option>
        <option value="back">Your Mon</option>
      </select>
      <select id="genderSelect" onchange="updatePokemon()" style="width: 100px;">
        <option value="M" selected>Male</option>
        <option value="F">Female</option>
      </select>
    <!-- </div> -->
    <div style="display: flex; gap: 5px; align-items: center;">
      <input type="number" id="levelInput" min="1" max="100" value="100" style="width: 45px;">
      <label style="margin: 0;">Shiny</label>
      <input type="checkbox" id="shinyToggle" style="margin: 0;">
    </div>
  </div>

</div>

<div style="margin-bottom: 0px;">
  <label>Add Custom Status:</label>
  <div style="display: flex; gap: 5px; flex-wrap: wrap;">
    <input type="text" id="statusInput" placeholder="eg. Tuberculosis" onkeydown="if(event.key === 'Enter') { event.preventDefault(); if(event.shiftKey) { addStatusText('bad'); } else { addStatusText('good'); } }">
    <button onclick="addStatusText('good')" style="background: rgb(229, 255, 224); color: rgb(51, 170, 0); display:inline-block;">Add Good</button>
    <button onclick="addStatusText('bad')" style="background: rgb(255, 229, 224); color: rgb(255, 68, 0); display:inline-block;">Add Bad</button>
  </div>
</div>

<script>
  function updateStatus(value) {
    const statusElement = document.getElementById('pokemonStatus');
    if (value === 'none') {
      statusElement.style.display = 'none';
    } else {
      statusElement.className = value;
      statusElement.innerText = value.toUpperCase();
      statusElement.style.display = 'block';
    }
  }
</script>

<div style="margin-bottom: 0px;">
  <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 0px;">
    <div style="max-width: 100px;">
      <label id="labelAtk">Atk:</label>
      <select id="selectAtk" onchange="updateStatMod('Atk', this.value)">
        <option value="-6">-6</option>
        <option value="-5">-5</option>
        <option value="-4">-4</option>
        <option value="-3">-3</option>
        <option value="-2">-2</option>
        <option value="-1">-1</option>
        <option selected value="0">+0</option>
        <option value="1">+1</option>
        <option value="2">+2</option>
        <option value="3">+3</option>
        <option value="4">+4</option>
        <option value="5">+5</option>
        <option value="6">+6</option>
      </select>
    </div>
    <div>
      <label id="labelDef">Def:</label>
      <select id="selectDef" onchange="updateStatMod('Def', this.value)">
        <option value="-6">-6</option>
        <option value="-5">-5</option>
        <option value="-4">-4</option>
        <option value="-3">-3</option>
        <option value="-2">-2</option>
        <option value="-1">-1</option>
        <option selected value="0">+0</option>
        <option value="1">+1</option>
        <option value="2">+2</option>
        <option value="3">+3</option>
        <option value="4">+4</option>
        <option value="5">+5</option>
        <option value="6">+6</option>
      </select>
    </div>
    <div>
      <label id="labelSpA">SpA:</label>
      <select id="selectSpA" onchange="updateStatMod('SpA', this.value)">
        <option value="-6">-6</option>
        <option value="-5">-5</option>
        <option value="-4">-4</option>
        <option value="-3">-3</option>
        <option value="-2">-2</option>
        <option value="-1">-1</option>
        <option selected value="0">+0</option>
        <option value="1">+1</option>
        <option value="2">+2</option>
        <option value="3">+3</option>
        <option value="4">+4</option>
        <option value="5">+5</option>
        <option value="6">+6</option>
      </select>
    </div>
    <div>
      <label id="labelSpD">SpD:</label>
      <select id="selectSpD" onchange="updateStatMod('SpD', this.value)">
        <option value="-6">-6</option>
        <option value="-5">-5</option>
        <option value="-4">-4</option>
        <option value="-3">-3</option>
        <option value="-2">-2</option>
        <option value="-1">-1</option>
        <option selected value="0">+0</option>
        <option value="1">+1</option>
        <option value="2">+2</option>
        <option value="3">+3</option>
        <option value="4">+4</option>
        <option value="5">+5</option>
        <option value="6">+6</option>
      </select>
    </div>
    <div>
      <label id="labelSpe">Spe:</label>
      <select id="selectSpe" onchange="updateStatMod('Spe', this.value)">
        <option value="-6">-6</option>
        <option value="-5">-5</option>
        <option value="-4">-4</option>
        <option value="-3">-3</option>
        <option value="-2">-2</option>
        <option value="-1">-1</option>
        <option selected value="0">+0</option>
        <option value="1">+1</option>
        <option value="2">+2</option>
        <option value="3">+3</option>
        <option value="4">+4</option>
        <option value="5">+5</option>
        <option value="6">+6</option>
      </select>
    </div>
  </div>
</div>

<div style="margin-bottom: 0px;">
  <!-- <label>Hazards:</label> -->
  <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 0px;">
    <div>
      <label>Rocks:</label>
      <select onchange="numRocks = parseInt(this.value); updatePokemon();">
        <option selected value="0">0</option>
        <option value="1">1</option>
      </select>
    </div>
    <div>
      <label>Spikes:</label>
      <select onchange="numSpikes = parseInt(this.value); updatePokemon();">
        <option selected value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
      </select>
    </div>
    <div>
      <label>T. Spikes:</label>
      <select onchange="numTSpikes = parseInt(this.value); updatePokemon();">
        <option selected value="0">0</option>
        <option value="1">1</option>
        <option value="2">2</option>
      </select>
    </div>
    <div>
      <label>Webs:</label>
      <select onchange="numStickyWeb = parseInt(this.value); updatePokemon();">
        <option selected value="0">0</option>
        <option value="1">1</option>
      </select>
    </div>
  </div>
</div>

<div style="margin-top: 0px; display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 0px;">
  <div style="max-width: 40%;">
  <label>Background:</label>
  <select id="backgroundSelect" onchange="updateBackground(this.value)" style="width: 150px; max-width: 100%;">
    <option value="bg-aquacordetown.jpg" selected>Aquacorde Town</option>
    <option value="transparent">TRANSPARENT</option>
    <option value="bg-beach.jpg">Beach</option>
    <option value="bg-city.jpg">City</option>
    <option value="bg-dampcave.jpg">Damp Cave</option>
    <option value="bg-darkbeach.jpg">Dark Beach</option>
    <option value="bg-darkcity.jpg">Dark City</option>
    <option value="bg-darkmeadow.jpg">Dark Meadow</option>
    <option value="bg-deepsea.jpg">Deep Sea</option>
    <option value="bg-desert.jpg">Desert</option>
    <option value="bg-earthycave.jpg">Earthy Cave</option>
    <option value="bg-elite4drake.jpg">Elite 4 Drake</option>
    <option value="bg-forest.jpg">Forest</option>
    <option value="bg-icecave.jpg">Ice Cave</option>
    <option value="bg-leaderwallace.jpg">Leader Wallace</option>
    <option value="bg-library.jpg">Library</option>
    <option value="bg-meadow.jpg">Meadow</option>
    <option value="bg-orasdesert.jpg">ORAS Desert</option>
    <option value="bg-orassea.jpg">ORAS Sea</option>
    <option value="bg-skypillar.jpg">Sky Pillar</option>
  </select>
  </div>
  <div class="badAppleButton" style="max-width: 60%;">
    <label>Bad Apple lol:</label>
    <button id="badAppleButton" onclick="playBadApple()">Bad Apple</button>
  </div>
</div>

<script>
  function updateBackground(value) {
    const container = document.querySelector('.monContainer');
    if (value === 'transparent') {
      container.style.backgroundImage = 'none';
      container.style.backgroundColor = 'white';
    } else {
      container.style.backgroundImage = `url(https://play.pokemonshowdown.com/sprites/gen6bgs/${value})`;
      container.style.backgroundColor = '';
    }
  }

  function updateTeraType(value) {
      const teraElement = document.getElementById('pokemonTera');
      if (value === 'none') {
        teraElement.style.display = 'none';
      } else {
        teraElement.src = `https://play.pokemonshowdown.com/sprites/types/${value.charAt(0).toUpperCase() + value.slice(1)}.png`;
        teraElement.alt = value.charAt(0).toUpperCase() + value.slice(1);
        teraElement.style.display = 'block';
      }
    }
function updateStatMod(stat, value) {
  const statElement = document.getElementById('stat' + stat);
  const numValue = parseInt(value);
  
  if (numValue === 0) {
    statElement.style.display = 'none';
    return;
  }

  const modifiers = {
    '-6': '0.25x',
    '-5': '0.29x', 
    '-4': '0.33x',
    '-3': '0.4x',
    '-2': '0.5x',
    '-1': '0.67x',
    '0': '1x',
    '1': '1.5x',
    '2': '2x',
    '3': '2.5x',
    '4': '3x',
    '5': '3.5x',
    '6': '4x'
  };

  statElement.style.display = 'block';
  statElement.innerText = `${modifiers[value]} ${stat}`;
  statElement.className = numValue > 0 ? 'good' : 'bad';
  statElement.onclick = function() {  
  //  this.style.display = 'none';
   updateStatMod(stat, '0');
  //  console.log("clicked",stat);
   document.getElementById('select' + stat).value = '0';
  }
}
</script>
</div>





</div>
<script>
document.getElementById('shinyToggle').addEventListener('change', updatePokemon);


document.getElementById('levelInput').addEventListener('change', function() {
  const value = parseInt(this.value);
  if (value < 1) this.value = 1;
  if (value > 100) this.value = 100;
  
  if (value === 100) document.getElementById('pokemonLevel').style.display = 'none';
  else document.getElementById('pokemonLevel').style.display = 'inline-block';
  document.getElementById('pokemonLevel').textContent = `L${this.value}`;
});


function updatePokemon() {
  // console.log("loading in pokemon no mon");
  // console.log("in update pokemon");
  // const input = document.getElementById('pokemonInput');
  // console.log("autocomplete", document.getElementById('autocomplete').innerHTML);
  let displayName = document.getElementById('autocomplete').innerText;
  // console.log("display name", document.getElementById('autocomplete').textContent);
  let pokemon = document.getElementById('autocomplete').textContent.toLowerCase().replace(" ", '') || firstMon.toLowerCase();
  // console.log("loading in pokemon", displayName);
  document.getElementById('pokemonInput').value = displayName;
  // let pokemon = document.getElementById('pokemonName').textContent.toLowerCase().replace(" ", '');
  if (pokemon.includes('-')) {
    let parts = pokemon.split('-');
    pokemon = parts[0] + "-" + parts.slice(1).join('');
  }
  const sprite = document.getElementById('pokemonSprite');
  const genderIcon = document.getElementById('pokemonGender');

  const isBack = document.getElementById('sideSelect').value === 'back';
  const isFemale = document.getElementById('genderSelect').value === 'F';
  const isShiny = document.getElementById('shinyToggle').checked;
  
  // Update sprite URL
  let spriteUrl = 'https://play.pokemonshowdown.com/sprites/';

  spriteUrl += isBack ? 'ani-back' : 'ani';
  if (isShiny) spriteUrl += '-shiny';
  spriteUrl += `/${pokemon}.gif`;
  
  const changeXDisplays = (el, numToChange) => {
    // get num of children of element
    const numChildren = el.children.length;
    //loop through element and set all display to none

    for (let i = 0; i < numChildren; i++) {
      el.children[i].style.display = 'none';
    }
    //loop through element and set all display to none
    for (let i = 0; i < numToChange; i++) {
      el.children[i].style.display = 'block';
    }
  }

  //UPDATE SPIKES AND WEBS
  changeXDisplays(document.getElementById('spikes'), numSpikes);
  changeXDisplays(document.getElementById('tspikes'), numTSpikes);
  changeXDisplays(document.getElementById('webs'), numStickyWeb);

  // CHANGE ROCK POSITION
  // console.log("isback numrocks", isBack, numRocks);
  if (isBack && numRocks > 0) {
    document.getElementById('rocksSelf').style.display = 'block';
    document.getElementById('rocksOpp').style.display = 'none';
  } else if (!isBack && numRocks > 0) {
    document.getElementById('rocksSelf').style.display = 'none';  
    document.getElementById('rocksOpp').style.display = 'block';
  } else if (numRocks === 0) {
    document.getElementById('rocksSelf').style.display = 'none';
    document.getElementById('rocksOpp').style.display = 'none';
  } 

  //CHANGE Z INDEX OF HAZARDS
  if (isBack) {
    document.getElementById('hazards').style.zIndex = 1;
  } else {
    document.getElementById('hazards').style.zIndex = 3;
  }

  //CHANGE NAME:
  document.getElementById('pokemonName').textContent = nickname || displayName || firstMon;

  const img = new Image();
  img.src = spriteUrl;
  
  img.onerror = function() {
    // If animated sprite fails to load, use static sprite
    sprite.src = spriteUrl.replace('ani', 'gen5').replace('.gif', '.png');
    
  };
  
  img.onload = function() {
    // If animated sprite loads successfully, use it
    sprite.src = spriteUrl;
    // Width is now controlled by CSS max-height on sprite and flexbox centering
  };
  
//   sprite.src = spriteUrl;
//   


  // Update gender icon
  genderIcon.src = `https://play.pokemonshowdown.com/fx/gender-${isFemale ? 'f' : 'm'}.png`;
  genderIcon.alt = isFemale ? 'F' : 'M';
}

// Initialize on page load
document.getElementById('autocomplete').textContent = 'Quagsire';
document.getElementById('pokemonInput').value = 'Quagsire';
updatePokemon();
updateBackground('bg-aquacordetown.jpg');

</script>
<script>

let all_apple_frames = [];
let statusDiv = document.getElementsByClassName('status')[0];
let currentFrame = 0;
let all_apple_spans = [];

makeAppleFrame = (frame) => {
  let spans = []
  for (let row of frame) {
    for (let pixel of row) {
      spans.push(pixel ? true : false);
    }
  }
  return spans;
}

  // Play the music when starting Bad Apple
  let music = document.getElementById('badAppleMusic');
  if (!music) {
    music = document.createElement('audio');
    music.id = 'badAppleMusic';
    music.src = './bad_apple_music.mp3';
    music.type = 'audio/mpeg';
    music.preload = 'auto';
    music.currentTime = 1;
    music.style.display = 'none';
    document.body.appendChild(music);
  }
  // play from start


  let last = 0;
  let lastUpdatedFrame = 0

  function playBadApple(timestamp) {
    // Limit to 30fps
    if (timestamp - last < 33.33333) {
      requestAnimationFrame(playBadApple);
      return;
    }
    last = timestamp;

    if (currentFrame >= all_apple_frames.length) {
      resetAll();
      document.getElementById('badAppleButton').textContent = "Bad Apple";
      document.getElementById('badAppleButton').onclick = function () {
        last = 0;              // reset pacing
        playBadApple();        // restart animation
      };
      
      for (let span of statusDiv.querySelectorAll('span')) {
        if (!span.id.toLowerCase().includes('stat') && !span.id.toLowerCase().includes('tera')) {statusDiv.removeChild(span);}
      }
      all_apple_spans = [];
      currentFrame = 0;
      music.currentTime = 0;
      music.pause();
      return;
    }

    document.getElementById('badAppleButton').textContent = "Stop";
    document.getElementById('badAppleButton').onclick = function () {
      currentFrame = 1000000;   // crude stop
    };

    if (currentFrame === 0) {
      currentFrame = 15;
      music.currentTime = 0.5;
      music.play();
      for (let i = 0; i < 108; i++) {
        let span = document.createElement('span');
        span.textContent = "_";
        span.id = "ba-" + i;
        all_apple_spans.push(span);
      }
      handleInput("hydrapple");
      handleNicknameInput("Bad Apple But...");
      addStatusText('good', "It's");
      addStatusText('good', "Pokemon");
      addStatusText('good', "Showdown");
      addStatusText('bad', ">:)");
      updatePokemon();
      // statusDiv.append(makeStatusElement('good'));
      statusDiv.append(...all_apple_spans);
    }

    let frameprint = all_apple_frames[currentFrame];
    for (let i = 0; i < 108; i++) {
      let span = all_apple_spans[i];
      span.classList.toggle("good", frameprint[i]);
      span.classList.toggle("bad", !frameprint[i]);
    }

    currentFrame++;
    lastUpdatedFrame++;
    if (lastUpdatedFrame > 15) {
      console.log("updating frame to keep up");
      let expectedFrame = Math.floor(music.currentTime * 30); // 30fps sync
      currentFrame = expectedFrame;
      lastUpdatedFrame = 0;
    }
    requestAnimationFrame(playBadApple);
  }


// Import bad_apple.json from this folder using fetch
let badAppleFrames = [];
fetch('./bad_apple.json')
  .then(response => response.json())
  .then(data => {
    badAppleFrames = data;

    all_apple_frames = badAppleFrames.map(frame => makeAppleFrame(frame));


  })
  .catch(err => {
    console.error("Could not load bad_apple.json:", err);
  });


</script>
</div>
</div>
</div>
</body>
</html>
